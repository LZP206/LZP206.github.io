# 凸优化学习笔记





### 共轭函数



#### Define

$$
{f^*}\left( y \right) = \mathop {\sup }\limits_{x \in domf} \{ {y^T}x - f\left( x \right)\}
$$



#### Property 

- 共轭函数${f^*}$的定义域是使得上式中sup结果小于$\infty$的部分；
- 从定义出发，共轭函数的几何意义是对于给定的$y$, ${f^*}\left( y \right)$等于线性函数${y^T}x$与原函数$f\left( y\right)$的最大值
- ${f^*}\left( y \right)$是凸函数。因为对于确定的$x$，$f\left( y\right)$是定值，而${y^T}x$是关于$y$的线性函数，而sup运算是保凸的，因此${f^*}\left( y \right)$是凸函数。这一点与$f\left( y\right)$是否是凸函数无关；
- Fenchel不等式：由共轭函数的定义，我们可以马上得到：$f\left( x \right) + {f^*}\left( y \right) \ge {y^T}x$；
- 共轭的反身性：如果函数$f\left( y\right)$是凸函数，那么${f^{**}}\left( x \right) = f\left( x \right)$，即凸函数共轭的共轭还是其本身；
- 线性变换复合函数的共轭：对于$a>0$，函数$g\left(x\right)=af\left(x\right)+b$的共轭函数为${g^*}\left(y\right)=a{f^*}\left({y/a}\right)-b$，对于矢量函数的情况，对于可逆矩阵$A$以及向量$b$，函数$g\left(x\right)=f\left({Ax+b}\right)$的共轭函数为：${g^*}\left(y\right)=f\left({{A^T}y}\right)-{b^T}{A^{-T}}y$；



#### 示例

**1）仿射函数**

仿射函数$f\left(x\right)=ax+b$的共轭函数为：
$$
{f^*}\left( y \right) = \mathop {\sup }\limits_{x \in domf} \{ yx - ax - b\}
$$
根据定义，可以看出当$y \ne a$，${f^*}\left( y \right) = \infty $；当$y = a$，${f^*}\left( y \right) = -b $。



**2）负熵函数**

负熵函数$f\left( x \right) = x\log x$的共轭函数为：
$$
{f^*}\left( y \right) = \mathop {\sup }\limits_{x \in domf} \{ yx - x\log x\}
$$
需要求出最优的$x^*$使得$y{x^*} - {x^*}\log {x^*}$取最大。令$yx-x\log x$关于$x$的导数为0，得$y-\log x -1=0$，即得$x^*=e^{y-1}$，代入得：
$$
{f^*}\left( y \right) = \mathop {\sup }\limits_{x \in domf} \{ yx - x\log x\}  = y{e^{y - 1}} - {e^{y - 1}}(y - 1) = {e^{y - 1}}
$$



**3）Log-sum-exp函数**

Log-sum-exp函数$f\left( x\right) =\log \left( {\sum\limits_{i = 1}^n {{e^{{x_i}}}} } \right)$的共轭函数为：
$$
{f^*}\left( y \right) = \mathop {\sup }\limits_{x \in domf} \{ {y^T}x - \log \left( {\sum\limits_{i = 1}^n {{e^{{x_i}}}} } \right)\}
$$
令${y^T}x - \log \left( {\sum\limits_{i = 1}^n {{e^{{x_i}}}} } \right)$关于$x$的导数为0，得${y_i} -  e^{x_i} / \sum\limits_{i = 1}^n {e^{x_i}} = 0$，即${x^*} = \log {y_i} + \log \left( {\sum\limits_{i = 1}^n {{e^{{x_i}}}} } \right)$，代入得：
$$
{f^*}\left( y \right) = \sum\limits_{i = 1}^n {{y_i}} \log {y_i} + \log \left( {\sum\limits_{i = 1}^n {{e^{{x_i}}}} } \right)\sum\limits_{i = 1}^n {{y_i}}  - \log \left( {\sum\limits_{i = 1}^n {{e^{{x_i}}}} } \right) = \sum\limits_{i = 1}^n {{y_i}} \log {y_i} + \log \left( {\sum\limits_{i = 1}^n {{e^{{x_i}}}} } \right)\left[ {\left( {\sum\limits_{i = 1}^n {{y_i}} } \right) - 1} \right]
$$
当$\sum\limits_{i=1}^{n} {e^{x_i}}=1$，${y_i} \ge 0$时，有${f^*}\left( y \right) = \sum\limits_{i = 1}^n {{y_i}} \log {y_i}$。



**4）范数Norm**

范数（Norm）$f(x) = {\left\| x \right\|_p}$的共轭函数为：
$$
{f^*}\left( y \right) = \left\{ \begin{array}{l}
	0,{\rm{     }}{\left\| y \right\|_*} \le 1\\
	\infty ,    otherwise{\rm{ }}
	\end{array} \right.
$$
其中$\left\|  y\right\| _*$表示函数$\left\|  y\right\|$的对偶范数。（对偶范数定义为${\left\| y \right\|_*} = \mathop {\sup }\limits_{\left\| x \right\| \le 1} \{ {y^T}x\} $）

> 证明：若${\left\| y \right\|_*} > 1$，根据对偶范数的定义，存在$\left\| z \right\| \le 1$使得${y^T}z > 1$。令$x = tz$，当$t \to \infty $时有：${y^T}x - \left\| x \right\| = t[{y^T}z - \left\| z \right\|] \to \infty $，即${y^T}x - \left\| x \right\| \le 0$，没有上界；
>
> 反之，当${\left\| y \right\|_*} \le 1$，根据对偶范数的定义，对任意$x$，有${y^T}x \le {\left\| y \right\|_*}\left\| x \right\| \le \left\| x \right\|$，即${y^T}x - \left\| x \right\| \le 0$。当$x$取0时等号成立，即${f^*}\left( y \right) = 0$。



















### 拟凸函数



#### Define

$\mathrm{dom} f$ 和 $f$ 的所有sublevel set 为凸集



#### Property 

$$
f(\theta  x+(1-\theta)y) \leq max \{f(x),f(y)\}
$$





#### 一阶条件 

$f$ 为quasiconvex $\iff$ dom $f$ 为convex，$\forall  x,y \in \mathrm{dom} f $ ，$f(y) \leq f(x)$，则$\nabla ^{\mathrm T}f(x)(y-x) \leq 0$



> **证明：**
>
> 1) ”$\Longrightarrow$“
>
> ​	$\because$ $f(\theta  x+(1-\theta)y) \leq max \{f(x),f(y)\}$，$f(y) \leq f(x)$
>
> ​	$\therefore$ $f(x) \geq f(\theta  x+(1-\theta)y) $
>
> ​	则$f(\theta  x+(1-\theta)y)- f(x) = f(\theta  x+(1-\theta)y) - f(\theta  x+(1-\theta)x)$ 
>
> ​													$= \frac{f(\theta  x+(1-\theta)y) - f(\theta  x+(1-\theta)x)}{(1-\theta)(y-x)} \times (1-\theta)(y-x) \le 0$ 
>
> ​	$\therefore$ $f^{\prime}  (x)(y-x) \le 0$
>
> ---
>
> 2) "$\Longleftarrow$"     证 $f(x) \geq f(\theta  x+(1-\theta)y) $ 即可
>
> ​	令$\theta  x+(1-\theta)y = z$，$x\ne y$，$\theta \in (0,1)$
>
> ​	1.若$x=y$，$\theta = 0,1$，显然得证$f(x)=f(z)$
>
> ​	2.若$f(z)\ge f(x)$，则$f(x)=f(z)$，证明如下：
> $$
> \begin{cases}
> f^{\prime}(z)(z-x)= f^{\prime}(z)(1-\theta)(x-y)\le 0 \\
> f^{\prime}(z)(z-y)= f^{\prime}(z)\theta(y-x)\le 0    
> \end{cases}
> $$
> ​		$\therefore$ $f^{\prime} (z)=0$，即$f(z)$ 处于$f(x)$和$f(y)$中间的高峰，
>
> ​			不断选取$x$与$z$之间的点，则$f(x)$不断逼近$f(y)$。
>
> ​	3.再证$f(z)<f(x)$
>
> ​		$\frac{f(z) - f(\theta  x+(1-\theta)x)}{(1-\theta)(y-x)} \times (1-\theta)(y-x) \le 0$ 	$\Longrightarrow$		$f(z)<f(x)$



#### 二阶条件

$f$ 为quasiconvex $\iff$ $\forall x \in \mathrm{dom}f$，$y \in \mathbb{R}^n$，$y^{\mathrm T} \nabla  f(x)=0$，则$y^{\mathrm T} \nabla^2  f(x) y \ge 0$



> **证明：**
>
> 考虑$y \ne 0$，则证明目标为$f^{\prime}(x)=0$	$ \Longrightarrow$	$f^{\prime \prime}(x)\ge0$
>
> 1) ”$\Longrightarrow$“
>
> ​	选取一点$x \in [a,b]$，$f$在$[a,b]$上拟凸。
>
> ​	假设$f^{\prime}(x)=0$，且$f^{\prime \prime}(x)\le 0$，那么$\exists \varepsilon >0$，s.t. $f(x+\varepsilon)< f(x)$，$f(x-\varepsilon)< f(x)$。
>
> ​	此时对于$f$的下水平集$\{ t|f(t)< f(x)-\varepsilon   \}为非凸集，矛盾。
>
> ---
>
> 2) "$\Longleftarrow$" 
>
> ​	已知$x \in [a,b]$并且$f^{\prime}(x)=0$，$f^{\prime \prime}(x)\ge0$，
>
> ​	那么$f$在$[a,b]$上先减后增，因此根据下水平集可判断$f$在$[a,b]$为拟凸函数。